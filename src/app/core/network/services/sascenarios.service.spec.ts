import { TestBed, async, inject } from '@angular/core/testing';
import { SaScenariosService } from './sascenarios.service';
import { SaDataService } from './sadata.service';
import { SaScenarioModel } from 'app/Models/SaScenarioModel';
import { SaData } from 'app/Models/SaData';
import { defer } from 'rxjs';

function asyncData<T>(data: T) {
  return defer(() => Promise.resolve(data));
}

describe('Service: Sascenarios', () => {
  let saScenariosService: SaScenariosService;
  let saDataServiceSpy: jasmine.SpyObj<SaDataService>;
  const fakeScenarioJSON: string = setFakeScenarioJSON();

  beforeEach(() => {
    TestBed.configureTestingModule({
      providers: [
        SaScenariosService,
        { provide: SaDataService, useValue: jasmine.createSpyObj('SaDataService', ['getSaScenario']) }
      ]
    });

    // Inject both the service-to-test and its (spy) dependency
    saScenariosService = TestBed.inject(SaScenariosService);
    saDataServiceSpy = TestBed.inject(SaDataService) as jasmine.SpyObj<SaDataService>;
    saDataServiceSpy.getSaScenario.and.returnValue(asyncData(JSON.parse(fakeScenarioJSON)));
  });

  it('#getFirsScenario should return scenario in memory, if exists', done => {
    const stubSaData = new SaData();
    stubSaData.urn = 123;
    saScenariosService.scenarios.push(new SaScenarioModel(stubSaData));

    saScenariosService.getFirstScenario(123).subscribe((scenarioFromMemory) => {
      expect(scenarioFromMemory).not.toBeNull();
      expect(scenarioFromMemory.urn).toBe(123);
      done();
    },
    fail
    );
  });

  it('#getFirstScenario should return scenario in localStorage, if it does not exist in memory', done => {
    localStorage.setItem(`urn#144083-scenario_0`,  fakeScenarioJSON);
    saScenariosService.getFirstScenario(144083).subscribe((scenarioFromLocalStorage) => {
      expect(scenarioFromLocalStorage).not.toBeNull();
      expect(scenarioFromLocalStorage.urn).toBe(144083);
      done();
    },
    fail
    );
    localStorage.removeItem(`urn#144083-scenario_0`);
  });

  it('#getFirstScenario should return scenario from API, if it does not exist in memory or local storage', done => {

    saScenariosService.getFirstScenario(123).subscribe((scenarioFromApi) => {
      expect(saDataServiceSpy.getSaScenario).toHaveBeenCalled();
      done();
    },
    fail
    );
  });

  function setFakeScenarioJSON() {
    // tslint:disable-next-line:max-line-length
    const fakeJSON = '{"data":{"urn":144083,"name":"Ark Castledown Primary Academy","financeType":"Academies","londonWeighting":"Neither","numberOfPupilsLatestTerm":393,"ofstedRating":"0","ofstedInspectionDate":null,"progressScore":1.43,"progressScoreType":"KS2 score","progress8Banding":0,"fsmLatestTerm":38.4,"latestTerm":"2018/2019","hasSixthForm":false,"overallPhase":"Primary","totalExpenditureLatestTerm":2063323.4,"totalIncomeLatestTerm":2120274.01,"teachersTotalLastTerm":18.8,"teachersLeaderLastTerm":2,"workforceTotalLastTerm":43.8,"sadSizeLookup":{"term":null,"overallPhase":"Primary","hasSixthForm":null,"noPupilsMin":386,"noPupilsMax":null,"sizeType":"Large"},"sadFSMLookup":{"term":null,"overallPhase":"Primary","hasSixthForm":null,"fsmMin":18.0001,"fsmMax":100,"fsmScale":"High FSM"},"sadAssesmentAreas":[{"assessmentAreaType":"Spending","assessmentAreaName":"Teaching staff","schoolDataLatestTerm":1311708.38,"totalForAreaTypeLatestTerm":2063323.4,"allTresholds":[{"scoreLow":0,"scoreHigh":0.3849,"ratingText":"Lowest 10% of similar schools","ratingColour":"Red"},{"scoreLow":0.385,"scoreHigh":0.4199,"ratingText":"Lowest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.42,"scoreHigh":0.4549,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.455,"scoreHigh":0.485,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"},{"scoreLow":0.4851,"scoreHigh":0.515,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.5151,"scoreHigh":0.55,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.5501,"scoreHigh":1,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":2000000,"schoolData":1000000,"calculatedSchoolData":0.5,"matchingTreshold":{"scoreLow":0.4851,"scoreHigh":0.515,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"}},{"assessmentAreaType":"Spending","assessmentAreaName":"Supply staff","schoolDataLatestTerm":36000,"totalForAreaTypeLatestTerm":2063323.4,"allTresholds":[{"scoreLow":0,"scoreHigh":0.0199,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.02,"scoreHigh":0.03,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"},{"scoreLow":0.0301,"scoreHigh":0.055,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.0551,"scoreHigh":0.075,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.0751,"scoreHigh":1,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":2000000,"schoolData":50000,"calculatedSchoolData":0.03,"matchingTreshold":{"scoreLow":0.02,"scoreHigh":0.03,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"}},{"assessmentAreaType":"Spending","assessmentAreaName":"Education support staff","schoolDataLatestTerm":189687.4,"totalForAreaTypeLatestTerm":2063323.4,"allTresholds":[{"scoreLow":0,"scoreHigh":0.1399,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.14,"scoreHigh":0.17,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"},{"scoreLow":0.1701,"scoreHigh":0.2,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.2001,"scoreHigh":0.235,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.2351,"scoreHigh":1,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":2000000,"schoolData":200000,"calculatedSchoolData":0.1,"matchingTreshold":{"scoreLow":0,"scoreHigh":0.1399,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"}},{"assessmentAreaType":"Spending","assessmentAreaName":"Administrative and clerical staff","schoolDataLatestTerm":125312.85,"totalForAreaTypeLatestTerm":2063323.4,"allTresholds":[{"scoreLow":0,"scoreHigh":0.075,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.0751,"scoreHigh":0.085,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.0851,"scoreHigh":1,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":2000000,"schoolData":100000,"calculatedSchoolData":0.05,"matchingTreshold":{"scoreLow":0,"scoreHigh":0.075,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"}},{"assessmentAreaType":"Spending","assessmentAreaName":"Other staff costs","schoolDataLatestTerm":20015.85,"totalForAreaTypeLatestTerm":2063323.4,"allTresholds":[{"scoreLow":0,"scoreHigh":0.05,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.0501,"scoreHigh":0.065,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.0651,"scoreHigh":1,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":2000000,"schoolData":20000,"calculatedSchoolData":0.01,"matchingTreshold":{"scoreLow":0,"scoreHigh":0.05,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"}},{"assessmentAreaType":"Spending","assessmentAreaName":"Premises costs","schoolDataLatestTerm":77604.39,"totalForAreaTypeLatestTerm":2063323.4,"allTresholds":[{"scoreLow":0,"scoreHigh":0.07,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.0701,"scoreHigh":0.085,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.0851,"scoreHigh":1,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":2000000,"schoolData":50000,"calculatedSchoolData":0.03,"matchingTreshold":{"scoreLow":0,"scoreHigh":0.07,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"}},{"assessmentAreaType":"Spending","assessmentAreaName":"Teaching resources","schoolDataLatestTerm":45542.92,"totalForAreaTypeLatestTerm":2063323.4,"allTresholds":[{"scoreLow":0,"scoreHigh":0.0299,"ratingText":"Lowest 10% of similar schools","ratingColour":"Red"},{"scoreLow":0.03,"scoreHigh":0.0399,"ratingText":"Lowest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.04,"scoreHigh":0.0499,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.05,"scoreHigh":0.06,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"},{"scoreLow":0.0601,"scoreHigh":1,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"}],"totalForAreaType":2000000,"schoolData":20000,"calculatedSchoolData":0.01,"matchingTreshold":{"scoreLow":0,"scoreHigh":0.0299,"ratingText":"Lowest 10% of similar schools","ratingColour":"Red"}},{"assessmentAreaType":"Spending","assessmentAreaName":"Energy","schoolDataLatestTerm":14039.23,"totalForAreaTypeLatestTerm":2063323.4,"allTresholds":[{"scoreLow":0,"scoreHigh":0.015,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.0151,"scoreHigh":0.02,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.0201,"scoreHigh":1,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":2000000,"schoolData":10000,"calculatedSchoolData":0.01,"matchingTreshold":{"scoreLow":0,"scoreHigh":0.015,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"}},{"assessmentAreaType":"Reserve and balance","assessmentAreaName":"In-year balance","schoolDataLatestTerm":56950.61,"totalForAreaTypeLatestTerm":2120274.01,"allTresholds":[{"scoreLow":-1,"scoreHigh":-0.05,"ratingText":"High Risk","ratingColour":"Red"},{"scoreLow":-0.0499,"scoreHigh":-0.0001,"ratingText":"Medium Risk","ratingColour":"Amber"},{"scoreLow":0,"scoreHigh":1,"ratingText":"Low Risk","ratingColour":"Light green"}],"totalForAreaType":2000000,"schoolData":0,"calculatedSchoolData":0,"matchingTreshold":{"scoreLow":0,"scoreHigh":1,"ratingText":"Low Risk","ratingColour":"Light green"}},{"assessmentAreaType":"Reserve and balance","assessmentAreaName":"Revenue reserve","schoolDataLatestTerm":223108.02,"totalForAreaTypeLatestTerm":2120274.01,"allTresholds":[{"scoreLow":-1,"scoreHigh":-0.05,"ratingText":"High Risk","ratingColour":"Red"},{"scoreLow":-0.0499,"scoreHigh":-0.0001,"ratingText":"Medium Risk","ratingColour":"Amber"},{"scoreLow":0,"scoreHigh":1,"ratingText":"Low Risk","ratingColour":"Light green"}],"totalForAreaType":2000000,"schoolData":200000,"calculatedSchoolData":0.1,"matchingTreshold":{"scoreLow":0,"scoreHigh":1,"ratingText":"Low Risk","ratingColour":"Light green"}},{"assessmentAreaType":"School characteristics","assessmentAreaName":"Average teacher cost","schoolDataLatestTerm":null,"totalForAreaTypeLatestTerm":null,"allTresholds":[{"scoreLow":0,"scoreHigh":43999.99,"ratingText":"Lowest 10% of similar schools","ratingColour":"Red"},{"scoreLow":44000,"scoreHigh":46999.99,"ratingText":"Lowest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":47000,"scoreHigh":49999.99,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":50000,"scoreHigh":53000,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"},{"scoreLow":53000.01,"scoreHigh":56500,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":56500.01,"scoreHigh":60000,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":60000.01,"scoreHigh":null,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":20,"schoolData":1000000,"calculatedSchoolData":50000,"matchingTreshold":{"scoreLow":50000,"scoreHigh":53000,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"}},{"assessmentAreaType":"School characteristics","assessmentAreaName":"Senior leaders as a percentage of workforce","schoolDataLatestTerm":null,"totalForAreaTypeLatestTerm":null,"allTresholds":[{"scoreLow":0,"scoreHigh":0.1049,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.105,"scoreHigh":0.135,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"},{"scoreLow":0.1351,"scoreHigh":0.17,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.1701,"scoreHigh":0.2,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.2001,"scoreHigh":1,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":50,"schoolData":2,"calculatedSchoolData":0.04,"matchingTreshold":{"scoreLow":0,"scoreHigh":0.1049,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"}},{"assessmentAreaType":"School characteristics","assessmentAreaName":"Pupil to teacher ratio","schoolDataLatestTerm":null,"totalForAreaTypeLatestTerm":null,"allTresholds":[{"scoreLow":0,"scoreHigh":10.99,"ratingText":"Lowest 10% of similar schools","ratingColour":"Red"},{"scoreLow":11,"scoreHigh":12.99,"ratingText":"Lowest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":13,"scoreHigh":15.49,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":15.5,"scoreHigh":17,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"},{"scoreLow":17.01,"scoreHigh":19,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":19.01,"scoreHigh":20.5,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":20.51,"scoreHigh":null,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":20,"schoolData":100,"calculatedSchoolData":5,"matchingTreshold":{"scoreLow":0,"scoreHigh":10.99,"ratingText":"Lowest 10% of similar schools","ratingColour":"Red"}},{"assessmentAreaType":"School characteristics","assessmentAreaName":"Pupil to adult ratio","schoolDataLatestTerm":null,"totalForAreaTypeLatestTerm":null,"allTresholds":[{"scoreLow":0,"scoreHigh":4.99,"ratingText":"Lowest 10% of similar schools","ratingColour":"Red"},{"scoreLow":5,"scoreHigh":5.49,"ratingText":"Lowest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":5.5,"scoreHigh":6.49,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":6.5,"scoreHigh":7.5,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"},{"scoreLow":7.51,"scoreHigh":8.5,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":8.51,"scoreHigh":9.5,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":9.51,"scoreHigh":null,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":50,"schoolData":100,"calculatedSchoolData":2,"matchingTreshold":{"scoreLow":0,"scoreHigh":4.99,"ratingText":"Lowest 10% of similar schools","ratingColour":"Red"}},{"assessmentAreaType":"School characteristics","assessmentAreaName":"Teacher contact ratio (less than 1)","schoolDataLatestTerm":null,"totalForAreaTypeLatestTerm":null,"allTresholds":[{"scoreLow":0,"scoreHigh":0.7,"ratingText":"Much lower than recommended","ratingColour":"Red"},{"scoreLow":0.7001,"scoreHigh":0.74,"ratingText":"Lower than recommended","ratingColour":"Amber"},{"scoreLow":0.7401,"scoreHigh":0.8,"ratingText":"Broadly in line with recommendations","ratingColour":"Light green"},{"scoreLow":0.8001,"scoreHigh":0.82,"ratingText":"Higher than recommended","ratingColour":"Amber"},{"scoreLow":0.8201,"scoreHigh":1,"ratingText":"Much higher than recommended","ratingColour":"Red"}],"calculatedSchoolData":0.5,"matchingTreshold":{"scoreLow":0,"scoreHigh":0.7,"ratingText":"Much lower than recommended","ratingColour":"Red"},"schoolData":0.5},{"assessmentAreaType":"School characteristics","assessmentAreaName":"Predicted percentage pupil number change in 3-5 years","schoolDataLatestTerm":null,"totalForAreaTypeLatestTerm":null,"allTresholds":[{"scoreLow":-1,"scoreHigh":-0.1,"ratingText":"High Risk","ratingColour":"Red"},{"scoreLow":-0.0999,"scoreHigh":-0.02,"ratingText":"Medium Risk","ratingColour":"Amber"},{"scoreLow":-0.0199,"scoreHigh":null,"ratingText":"Low Risk","ratingColour":"Light green"}],"calculatedSchoolData":0.1,"matchingTreshold":{"scoreLow":-0.0199,"scoreHigh":null,"ratingText":"Low Risk","ratingColour":"Light green"},"schoolData":0.1},{"assessmentAreaType":"School characteristics","assessmentAreaName":"Average Class size","schoolDataLatestTerm":null,"totalForAreaTypeLatestTerm":null,"allTresholds":[{"scoreLow":0,"scoreHigh":12.99,"ratingText":"Lowest 10% of similar schools","ratingColour":"Red"},{"scoreLow":13,"scoreHigh":16.49,"ratingText":"Lowest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":16.5,"scoreHigh":19.49,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":19.5,"scoreHigh":22.5,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"},{"scoreLow":22.51,"scoreHigh":24,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":24.01,"scoreHigh":25.5,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":25.51,"scoreHigh":null,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"calculatedSchoolData":50,"matchingTreshold":{"scoreLow":25.51,"scoreHigh":null,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"},"schoolData":50}]},"name":"Ark Castledown Primary Academy","urn":144083,"latestTerm":"2018/2019","financeType":"Academies","hasSixthForm":false,"overallPhase":"Primary","londonWeighting":"Neither","numberOfPupilsLatestTerm":393,"fsmLatestTerm":38.4,"ofstedRating":"0","ofstedInspectionDate":null,"progressScore":1.43,"progressScoreType":"KS2 score","progress8Banding":0,"totalExpenditureLatestTerm":2063323.4,"totalIncomeLatestTerm":2120274.01,"teachersTotalLastTerm":18.8,"teachersLeaderLastTerm":2,"workforceTotalLastTerm":43.8,"sadSizeLookup":{"term":null,"overallPhase":"Primary","hasSixthForm":null,"noPupilsMin":1,"noPupilsMax":100,"sizeType":"Very small"},"sadFSMLookup":{"term":null,"overallPhase":"Primary","hasSixthForm":null,"fsmMin":18.0001,"fsmMax":100,"fsmScale":"High FSM"},"sadAssessmentAreas":[{"assessmentAreaType":"Spending","assessmentAreaName":"Teaching staff","schoolDataLatestTerm":1311708.38,"totalForAreaTypeLatestTerm":2063323.4,"allTresholds":[{"scoreLow":0,"scoreHigh":0.3849,"ratingText":"Lowest 10% of similar schools","ratingColour":"Red"},{"scoreLow":0.385,"scoreHigh":0.4199,"ratingText":"Lowest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.42,"scoreHigh":0.4549,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.455,"scoreHigh":0.485,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"},{"scoreLow":0.4851,"scoreHigh":0.515,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.5151,"scoreHigh":0.55,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.5501,"scoreHigh":1,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":2000000,"schoolData":1000000,"calculatedSchoolData":0.5,"matchingTreshold":{"scoreLow":0.4851,"scoreHigh":0.515,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"}},{"assessmentAreaType":"Spending","assessmentAreaName":"Supply staff","schoolDataLatestTerm":36000,"totalForAreaTypeLatestTerm":2063323.4,"allTresholds":[{"scoreLow":0,"scoreHigh":0.0199,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.02,"scoreHigh":0.03,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"},{"scoreLow":0.0301,"scoreHigh":0.055,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.0551,"scoreHigh":0.075,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.0751,"scoreHigh":1,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":2000000,"schoolData":50000,"calculatedSchoolData":0.03,"matchingTreshold":{"scoreLow":0.02,"scoreHigh":0.03,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"}},{"assessmentAreaType":"Spending","assessmentAreaName":"Education support staff","schoolDataLatestTerm":189687.4,"totalForAreaTypeLatestTerm":2063323.4,"allTresholds":[{"scoreLow":0,"scoreHigh":0.1399,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.14,"scoreHigh":0.17,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"},{"scoreLow":0.1701,"scoreHigh":0.2,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.2001,"scoreHigh":0.235,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.2351,"scoreHigh":1,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":2000000,"schoolData":200000,"calculatedSchoolData":0.1,"matchingTreshold":{"scoreLow":0,"scoreHigh":0.1399,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"}},{"assessmentAreaType":"Spending","assessmentAreaName":"Administrative and clerical staff","schoolDataLatestTerm":125312.85,"totalForAreaTypeLatestTerm":2063323.4,"allTresholds":[{"scoreLow":0,"scoreHigh":0.075,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.0751,"scoreHigh":0.085,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.0851,"scoreHigh":1,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":2000000,"schoolData":100000,"calculatedSchoolData":0.05,"matchingTreshold":{"scoreLow":0,"scoreHigh":0.075,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"}},{"assessmentAreaType":"Spending","assessmentAreaName":"Other staff costs","schoolDataLatestTerm":20015.85,"totalForAreaTypeLatestTerm":2063323.4,"allTresholds":[{"scoreLow":0,"scoreHigh":0.05,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.0501,"scoreHigh":0.065,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.0651,"scoreHigh":1,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":2000000,"schoolData":20000,"calculatedSchoolData":0.01,"matchingTreshold":{"scoreLow":0,"scoreHigh":0.05,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"}},{"assessmentAreaType":"Spending","assessmentAreaName":"Premises costs","schoolDataLatestTerm":77604.39,"totalForAreaTypeLatestTerm":2063323.4,"allTresholds":[{"scoreLow":0,"scoreHigh":0.07,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.0701,"scoreHigh":0.085,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.0851,"scoreHigh":1,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":2000000,"schoolData":50000,"calculatedSchoolData":0.03,"matchingTreshold":{"scoreLow":0,"scoreHigh":0.07,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"}},{"assessmentAreaType":"Spending","assessmentAreaName":"Teaching resources","schoolDataLatestTerm":45542.92,"totalForAreaTypeLatestTerm":2063323.4,"allTresholds":[{"scoreLow":0,"scoreHigh":0.0299,"ratingText":"Lowest 10% of similar schools","ratingColour":"Red"},{"scoreLow":0.03,"scoreHigh":0.0399,"ratingText":"Lowest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.04,"scoreHigh":0.0499,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.05,"scoreHigh":0.06,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"},{"scoreLow":0.0601,"scoreHigh":1,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"}],"totalForAreaType":2000000,"schoolData":20000,"calculatedSchoolData":0.01,"matchingTreshold":{"scoreLow":0,"scoreHigh":0.0299,"ratingText":"Lowest 10% of similar schools","ratingColour":"Red"}},{"assessmentAreaType":"Spending","assessmentAreaName":"Energy","schoolDataLatestTerm":14039.23,"totalForAreaTypeLatestTerm":2063323.4,"allTresholds":[{"scoreLow":0,"scoreHigh":0.015,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.0151,"scoreHigh":0.02,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.0201,"scoreHigh":1,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":2000000,"schoolData":10000,"calculatedSchoolData":0.01,"matchingTreshold":{"scoreLow":0,"scoreHigh":0.015,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"}},{"assessmentAreaType":"Reserve and balance","assessmentAreaName":"In-year balance","schoolDataLatestTerm":56950.61,"totalForAreaTypeLatestTerm":2120274.01,"allTresholds":[{"scoreLow":-1,"scoreHigh":-0.05,"ratingText":"High Risk","ratingColour":"Red"},{"scoreLow":-0.0499,"scoreHigh":-0.0001,"ratingText":"Medium Risk","ratingColour":"Amber"},{"scoreLow":0,"scoreHigh":1,"ratingText":"Low Risk","ratingColour":"Light green"}],"totalForAreaType":2000000,"schoolData":0,"calculatedSchoolData":0,"matchingTreshold":{"scoreLow":0,"scoreHigh":1,"ratingText":"Low Risk","ratingColour":"Light green"}},{"assessmentAreaType":"Reserve and balance","assessmentAreaName":"Revenue reserve","schoolDataLatestTerm":223108.02,"totalForAreaTypeLatestTerm":2120274.01,"allTresholds":[{"scoreLow":-1,"scoreHigh":-0.05,"ratingText":"High Risk","ratingColour":"Red"},{"scoreLow":-0.0499,"scoreHigh":-0.0001,"ratingText":"Medium Risk","ratingColour":"Amber"},{"scoreLow":0,"scoreHigh":1,"ratingText":"Low Risk","ratingColour":"Light green"}],"totalForAreaType":2000000,"schoolData":200000,"calculatedSchoolData":0.1,"matchingTreshold":{"scoreLow":0,"scoreHigh":1,"ratingText":"Low Risk","ratingColour":"Light green"}},{"assessmentAreaType":"School characteristics","assessmentAreaName":"Average teacher cost","schoolDataLatestTerm":null,"totalForAreaTypeLatestTerm":null,"allTresholds":[{"scoreLow":0,"scoreHigh":43999.99,"ratingText":"Lowest 10% of similar schools","ratingColour":"Red"},{"scoreLow":44000,"scoreHigh":46999.99,"ratingText":"Lowest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":47000,"scoreHigh":49999.99,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":50000,"scoreHigh":53000,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"},{"scoreLow":53000.01,"scoreHigh":56500,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":56500.01,"scoreHigh":60000,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":60000.01,"scoreHigh":null,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":20,"schoolData":1000000,"calculatedSchoolData":50000,"matchingTreshold":{"scoreLow":50000,"scoreHigh":53000,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"}},{"assessmentAreaType":"School characteristics","assessmentAreaName":"Senior leaders as a percentage of workforce","schoolDataLatestTerm":null,"totalForAreaTypeLatestTerm":null,"allTresholds":[{"scoreLow":0,"scoreHigh":0.1049,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.105,"scoreHigh":0.135,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"},{"scoreLow":0.1351,"scoreHigh":0.17,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":0.1701,"scoreHigh":0.2,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":0.2001,"scoreHigh":1,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":50,"schoolData":2,"calculatedSchoolData":0.04,"matchingTreshold":{"scoreLow":0,"scoreHigh":0.1049,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"}},{"assessmentAreaType":"School characteristics","assessmentAreaName":"Pupil to teacher ratio","schoolDataLatestTerm":null,"totalForAreaTypeLatestTerm":null,"allTresholds":[{"scoreLow":0,"scoreHigh":10.99,"ratingText":"Lowest 10% of similar schools","ratingColour":"Red"},{"scoreLow":11,"scoreHigh":12.99,"ratingText":"Lowest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":13,"scoreHigh":15.49,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":15.5,"scoreHigh":17,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"},{"scoreLow":17.01,"scoreHigh":19,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":19.01,"scoreHigh":20.5,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":20.51,"scoreHigh":null,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":20,"schoolData":100,"calculatedSchoolData":5,"matchingTreshold":{"scoreLow":0,"scoreHigh":10.99,"ratingText":"Lowest 10% of similar schools","ratingColour":"Red"}},{"assessmentAreaType":"School characteristics","assessmentAreaName":"Pupil to adult ratio","schoolDataLatestTerm":null,"totalForAreaTypeLatestTerm":null,"allTresholds":[{"scoreLow":0,"scoreHigh":4.99,"ratingText":"Lowest 10% of similar schools","ratingColour":"Red"},{"scoreLow":5,"scoreHigh":5.49,"ratingText":"Lowest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":5.5,"scoreHigh":6.49,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":6.5,"scoreHigh":7.5,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"},{"scoreLow":7.51,"scoreHigh":8.5,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":8.51,"scoreHigh":9.5,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":9.51,"scoreHigh":null,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"totalForAreaType":50,"schoolData":100,"calculatedSchoolData":2,"matchingTreshold":{"scoreLow":0,"scoreHigh":4.99,"ratingText":"Lowest 10% of similar schools","ratingColour":"Red"}},{"assessmentAreaType":"School characteristics","assessmentAreaName":"Teacher contact ratio (less than 1)","schoolDataLatestTerm":null,"totalForAreaTypeLatestTerm":null,"allTresholds":[{"scoreLow":0,"scoreHigh":0.7,"ratingText":"Much lower than recommended","ratingColour":"Red"},{"scoreLow":0.7001,"scoreHigh":0.74,"ratingText":"Lower than recommended","ratingColour":"Amber"},{"scoreLow":0.7401,"scoreHigh":0.8,"ratingText":"Broadly in line with recommendations","ratingColour":"Light green"},{"scoreLow":0.8001,"scoreHigh":0.82,"ratingText":"Higher than recommended","ratingColour":"Amber"},{"scoreLow":0.8201,"scoreHigh":1,"ratingText":"Much higher than recommended","ratingColour":"Red"}],"calculatedSchoolData":0.5,"matchingTreshold":{"scoreLow":0,"scoreHigh":0.7,"ratingText":"Much lower than recommended","ratingColour":"Red"},"schoolData":0.5},{"assessmentAreaType":"School characteristics","assessmentAreaName":"Predicted percentage pupil number change in 3-5 years","schoolDataLatestTerm":null,"totalForAreaTypeLatestTerm":null,"allTresholds":[{"scoreLow":-1,"scoreHigh":-0.1,"ratingText":"High Risk","ratingColour":"Red"},{"scoreLow":-0.0999,"scoreHigh":-0.02,"ratingText":"Medium Risk","ratingColour":"Amber"},{"scoreLow":-0.0199,"scoreHigh":null,"ratingText":"Low Risk","ratingColour":"Light green"}],"calculatedSchoolData":0.1,"matchingTreshold":{"scoreLow":-0.0199,"scoreHigh":null,"ratingText":"Low Risk","ratingColour":"Light green"},"schoolData":0.1},{"assessmentAreaType":"School characteristics","assessmentAreaName":"Average Class size","schoolDataLatestTerm":null,"totalForAreaTypeLatestTerm":null,"allTresholds":[{"scoreLow":0,"scoreHigh":12.99,"ratingText":"Lowest 10% of similar schools","ratingColour":"Red"},{"scoreLow":13,"scoreHigh":16.49,"ratingText":"Lowest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":16.5,"scoreHigh":19.49,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":19.5,"scoreHigh":22.5,"ratingText":"Middle 20% of similar schools","ratingColour":"Dark green"},{"scoreLow":22.51,"scoreHigh":24,"ratingText":"Broadly in line with similar schools","ratingColour":"Light green"},{"scoreLow":24.01,"scoreHigh":25.5,"ratingText":"Highest 20% of similar schools","ratingColour":"Amber"},{"scoreLow":25.51,"scoreHigh":null,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"}],"calculatedSchoolData":50,"matchingTreshold":{"scoreLow":25.51,"scoreHigh":null,"ratingText":"Highest 10% of similar schools","ratingColour":"Red"},"schoolData":50}],"termOfScenario":"2019/2020","scenarioName":"castledown 2020","totalIncome":2000000,"totalExpenditure":2000000,"numberOfPupils":100,"fsm":40,"teachersTotal":20,"teachersLeader":2,"workforceTotal":50,"isTresholdsRefreshed":true,"scenarioNo":0,"isEdited":true}';

    return fakeJSON;
  }
});

