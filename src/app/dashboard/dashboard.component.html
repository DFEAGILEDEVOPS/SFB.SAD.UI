<div *ngIf='scenarioLoaded && activeScenario?.isTresholdsRefreshed'>

  <app-dashboard-bread-crumb [urn]='activeScenario.urn' [name]='activeScenario.name' class="hide-in-print"></app-dashboard-bread-crumb>

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
      <h1 class="govuk-heading-xl" id="h1">Self-assessment dashboard</h1>
      <div class="govuk-caption-m date-caption" id="dateCaption" *ngIf='activeScenario.isEdited'>Page last edited: {{activeScenario.lastEditTimeStamp | date: 'dd/MM/yy, HH:mm'}}</div>
      <p class="govuk-body-s" id="assessing">
        Assessing
        <span class="highlight">
          <span class="govuk-!-font-weight-bold">{{activeScenario.name}}</span>
        </span>
        using
        <span class="govuk-!-font-weight-bold">{{activeScenario.termOfScenario}}</span>
        finance data.

        <span *ngIf="this.activeScenario.financeType === 'Academies'">
          This data includes
          <span class="govuk-!-font-weight-bold">MAT central finance</span>.
        </span>
      </p>
    </div>
  </div>
  <div class="govuk-warning-text" *ngIf='!activeScenario.isReturnsComplete' id="partialWarning">
    <span class="govuk-warning-text__icon" aria-hidden="true">!</span>
    <strong class="govuk-warning-text__text">
      <span class="govuk-warning-text__assistive">Warning</span>
      <span id="partialWarning__text">
      This school doesn't have a complete set of financial data for this period. You should edit the values with more up to date information.
      </span>
    </strong>
  </div>
  <app-dashboard-characteristics [phase]='activeScenario.overallPhaseWSixthForm'
    [londonWeight]='activeScenario.londonWeighting' [noPupils]='activeScenario.numberOfPupils'
    [FSM]='activeScenario.fsm' [SizeLookup]='activeScenario.sadSizeLookup' [FSMLookup]='activeScenario.sadFSMLookup'>
  </app-dashboard-characteristics>

  <div class="govuk-grid-row hide-in-print">
    <div class="govuk-grid-column-one-half">
      <a [routerLink]="" class="govuk-link a-button govuk-!-font-weight-bold" (click)='onDownload()'>
        <img src="assets/images/download.svg" class="small-icon" alt="" />
        <span id="downloadPage"> Download page</span>
      </a>
      <a [routerLink]="" class="govuk-link a-button govuk-!-font-weight-bold ml-4" (click)='onPrintPage()'>
        <img src="assets/images/print.svg" class="small-icon" alt="" />
        <span> Print page</span>
      </a>
    </div>
    <div class="govuk-grid-column-one-half sbs-buttons-wrapper">
      <div class="sbs-buttons">
        <button class="govuk-button hide-in-print" data-module="govuk-button"
          routerLink='/self-assessment/edit-data/{{urn}}/enter' [disabled]='!this.scenarioLoaded'>
          Add a side-by-side scenario
        </button>
        <button *ngIf='activeScenario.isEdited' class="govuk-button govuk-button--secondary reset-button" data-module="govuk-button"
          (click)='onReset()'>
          Reset dashboard
        </button>
      </div>
    </div>
  </div>

  <h2 class="govuk-heading-m" id="scenarioName">{{activeScenario.scenarioName}}</h2>

  <div class="govuk-caption-m" id="scenarioYear">Scenario year {{activeScenario.termOfScenario}}</div>

  <div class="govuk-!-margin-bottom-3">
    <a class="govuk-link hide-in-print" routerLink='/self-assessment/edit-data/{{urn}}/edit' [hidden]='!this.scenarioLoaded'>
      Edit data
    </a>
  </div>

  <app-dashboard-table-desktop *ngIf='!isMobileScreen' [activeScenario]='activeScenario' (modalTriggered) = 'openModalWithComponent($event)'>
  </app-dashboard-table-desktop>

  <app-dashboard-table-mobile *ngIf='isMobileScreen' [activeScenario]='activeScenario' (modalTriggered) = 'openModalWithComponent($event)'>
  </app-dashboard-table-mobile>

</div>

<div [hidden]='scenarioLoaded && activeScenario.isTresholdsRefreshed'>Loading...</div>
