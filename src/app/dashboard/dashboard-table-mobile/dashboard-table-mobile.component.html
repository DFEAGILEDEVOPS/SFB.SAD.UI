<div class="mobile-tables">

  <h3 class="govuk-heading-m govuk-!-margin-top-9">Reserve and balance</h3>

  <table class="govuk-table" *ngFor='let aa of activeScenario.reserveAAs'>
    <caption class="govuk-table__caption bottom-border">{{aa.assessmentAreaName}}</caption>
    <tr class="govuk-table__row" >
      <th scope="row" class="govuk-table__header">School data</th>
      <td class="govuk-table__cell">{{aa.schoolData | aaValueFormat}}</td>
    </tr>
    <tr class="govuk-table__row" >
      <th scope="row" class="govuk-table__header">% of income</th>
      <td class="govuk-table__cell">{{aa.calculatedSchoolData | aaValueFormat : aa.assessmentAreaName}}</td>
    </tr>
    <tr class="govuk-table__row" >
      <th scope="row" class="govuk-table__header">Rating against tresholds</th>
      <td *ngIf="aa.schoolData != null && aa.matchingTreshold" class="govuk-table__cell">
        <span class="rating-box" [class]='aa.matchingTreshold.ratingColour'>{{aa.matchingTreshold.ratingText}}</span>
        <img src="assets/images/help-icon.png" class="small-icon rating-help-icon"
          (click)="openModalWithComponent(aa.assessmentAreaName)" />
      </td>
      <td *ngIf="aa.schoolData == null" class="govuk-table__cell">
        <span class="rating-box gray">
          <span>Not available.</span><br>
          <a class="govuk-link ml-2 button-link hide-in-print"
          routerLink='/self-assessment/add-missing-data/{{activeScenario.urn}}/{{aa.assessmentAreaName}}'>Add data</a>
        </span>
        <img src="assets/images/help-icon.png" class="small-icon rating-help-icon"
        (click)="openModalWithComponent(aa.assessmentAreaName)" />
      </td>
    </tr>
  </table>

  <h3 class="govuk-heading-m govuk-!-margin-top-9">Spending</h3>

  <table class="govuk-table" *ngFor='let aa of activeScenario.spendingAAs'>
    <caption class="govuk-table__caption bottom-border">{{aa.assessmentAreaName}}</caption>
    <tr class="govuk-table__row" >
      <th scope="row" class="govuk-table__header">School data</th>
      <td class="govuk-table__cell">{{aa.schoolData | aaValueFormat}}</td>
    </tr>
    <tr class="govuk-table__row" >
      <th scope="row" class="govuk-table__header">% of exp.</th>
      <td class="govuk-table__cell">{{aa.calculatedSchoolData | aaValueFormat : aa.assessmentAreaName}}</td>
    </tr>
    <tr class="govuk-table__row" >
      <th scope="row" class="govuk-table__header">Rating against tresholds</th>
      <td *ngIf="aa.schoolData != null && aa.matchingTreshold" class="govuk-table__cell">
        <span class="rating-box" [class]='aa.matchingTreshold.ratingColour'>{{aa.matchingTreshold.ratingText}}</span>
        <img src="assets/images/help-icon.png" class="small-icon rating-help-icon"
          (click)="openModalWithComponent(aa.assessmentAreaName)" />
      </td>
      <td *ngIf="aa.schoolData == null" class="govuk-table__cell">
        <span class="rating-box gray">
          <span>Not available.</span><br>
          <a class="govuk-link ml-2 button-link hide-in-print"
          routerLink='/self-assessment/add-missing-data/{{activeScenario.urn}}/{{aa.assessmentAreaName}}'>Add data</a>
        </span>
        <img src="assets/images/help-icon.png" class="small-icon rating-help-icon"
        (click)="openModalWithComponent(aa.assessmentAreaName)" />
      </td>
    </tr>
  </table>

  <h3 class="govuk-heading-m govuk-!-margin-top-9">School characteristics</h3>

  <table class="govuk-table" *ngFor='let aa of activeScenario.characteristicAAs'>
    <caption class="govuk-table__caption bottom-border">{{aa.assessmentAreaName}}</caption>
    <tr class="govuk-table__row" >
      <th scope="row" class="govuk-table__header">School data</th>
      <td class="govuk-table__cell">{{aa.calculatedSchoolData | aaValueFormat : aa.assessmentAreaName}}</td>
    </tr>
    <tr class="govuk-table__row">
      <th scope="row" class="govuk-table__header">Rating against tresholds</th>
      <td *ngIf="aa.schoolData != null && aa.matchingTreshold" class="govuk-table__cell">
        <span class="rating-box" [class]='aa.matchingTreshold.ratingColour'>{{aa.matchingTreshold.ratingText}}</span>
        <img src="assets/images/help-icon.png" class="small-icon rating-help-icon"
          (click)="openModalWithComponent(aa.assessmentAreaName)" />
      </td>
      <td *ngIf='aa.schoolData == null || aa.schoolData === undefined' class="govuk-table__cell">
        <span class="rating-box gray">
          <span>Not available.</span><br>
          <a class="govuk-link ml-2 button-link hide-in-print"
            routerLink='/self-assessment/add-missing-data/{{activeScenario.urn}}/{{aa.assessmentAreaName}}'>Add data</a>
        </span>
        <img src="assets/images/help-icon.png" class="small-icon rating-help-icon"
          (click)="openModalWithComponent(aa.assessmentAreaName)" />
      </td>
    </tr>
  </table>

  <h3 class="govuk-heading-m govuk-!-margin-top-9">Outcomes</h3>

  <table class="govuk-table">
    <caption class="govuk-table__caption bottom-border">Ofsted rating</caption>
    <tr class="govuk-table__row" >
      <th scope="row" class="govuk-table__header">School data</th>
      <td class="govuk-table__cell">
        <div class="ofsted-info-wrapper">
          <span class="rating rating-{{activeScenario.ofstedRating}}"> {{activeScenario.ofstedRating}} </span>
          <span [ngSwitch]="activeScenario.ofstedRating">
            <span class="govuk-!-font-weight-bold" *ngSwitchCase="'1'"> Outstanding</span>
            <span class="govuk-!-font-weight-bold" *ngSwitchCase="'2'"> Good</span>
            <span class="govuk-!-font-weight-bold" *ngSwitchCase="'3'"> Requires improvement</span>
            <span class="govuk-!-font-weight-bold" *ngSwitchCase="'4'"> Inadequate</span>
          </span> |
          <a class="govuk-link" target="_blank" rel="external noopener noreferrer"
            href="https://reports.ofsted.gov.uk/inspection-reports/find-inspection-report/provider/ELS/{{activeScenario.urn}}">Ofsted
            report</a><br>
          <span *ngIf='activeScenario.ofstedInspectionDate'>Inspected
            {{ activeScenario.ofstedInspectionDate | date : 'dd MMMM yyyy' }}</span>
        </div>
        <img src="assets/images/help-icon.png" class="small-icon rating-help-icon ofsted-icon"
        (click)="openModalWithComponent('Ofsted')" />
      </td>
    </tr>
  </table>

  <table class="govuk-table" *ngIf="activeScenario.progressScoreType === 'KS2 score'">
    <caption class="govuk-table__caption bottom-border">{{activeScenario.progressScoreType}}</caption>
    <tr class="govuk-table__row" >
      <th scope="row" class="govuk-table__header">School data</th>
      <td class="govuk-table__cell progress-td">
        <div class="progress-text-wrapper">
          <span *ngIf='activeScenario.progressScore' class="progress-text" [ngClass]="{
                'progress-text--well-below': activeScenario.progressScore < -3 ,
                'progress-text--below': activeScenario.progressScore >= -3 && activeScenario.progressScore < -2,
                'progress-text--average': activeScenario.progressScore >= -2 && activeScenario.progressScore <= 2,
                'progress-text--above': activeScenario.progressScore <= 3 && activeScenario.progressScore > 2,
                'progress-text--well-above': activeScenario.progressScore > 3}">
            {{activeScenario.progressScore | number: '1.2-2'}}
            <span *ngIf="activeScenario.progressScore < -3">&nbsp; Well below average</span>
            <span *ngIf="activeScenario.progressScore >= -3 && activeScenario.progressScore < -2">&nbsp; Below
              average</span>
            <span *ngIf="activeScenario.progressScore >= -2 && activeScenario.progressScore <= 2">&nbsp;
              Average</span>
            <span *ngIf="activeScenario.progressScore <= 3 && activeScenario.progressScore > 2">&nbsp; Above
              average</span>
            <span *ngIf="activeScenario.progressScore > 3">&nbsp; Well above average</span>
          </span>
          <span [hidden]='activeScenario.progressScore' style="float: left;">N/A</span>
        </div>
        <img src="assets/images/help-icon.png" class="small-icon rating-help-icon progress-icon"
        (click)="openModalWithComponent('KS2')"/>
      </td>
    </tr>
  </table>

  <table class="govuk-table" *ngIf="activeScenario.progressScoreType === 'Progress 8 score'">
    <caption class="govuk-table__caption bottom-border">{{activeScenario.progressScoreType}}</caption>
    <tr class="govuk-table__row" >
      <th scope="row" class="govuk-table__header">School data</th>
      <td class="govuk-table__cell progress-td">
        <div class="progress-text-wrapper">
          <span *ngIf='activeScenario.progressScore' class="progress-text" [ngClass]="{
                    'progress-text--well-below': activeScenario.progress8Banding === 5,
                    'progress-text--below': activeScenario.progress8Banding === 4,
                    'progress-text--average': activeScenario.progress8Banding === 3,
                    'progress-text--above': activeScenario.progress8Banding === 2,
                    'progress-text--well-above': activeScenario.progress8Banding === 1}">
            {{activeScenario.progressScore | number: '1.2-2'}}
            <span [ngSwitch]="activeScenario.progress8Banding">
              <span *ngSwitchCase="5">&nbsp; Well below average</span>
              <span *ngSwitchCase="4">&nbsp; Below average</span>
              <span *ngSwitchCase="3">&nbsp; Average</span>
              <span *ngSwitchCase="2">&nbsp; Above average</span>
              <span *ngSwitchCase="1">&nbsp; Well above average</span>
            </span>
          </span>
          <span [hidden]='activeScenario.progressScore' style="float: left;">N/A</span>
        </div>
        <img src="assets/images/help-icon.png" class="small-icon rating-help-icon progress-icon"
        (click)="openModalWithComponent('P8')"/>
      </td>
    </tr>
  </table>
</div>
